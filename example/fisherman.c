//32x16
char mouse[] = {0x0,0x0,0x0,0x0,0x0,0x0,0x0,0xcc,0xb0,0xc,0xcc,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0xc,0x1f,0xfb,0xc1,0x1f,0xb0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0xcc,0xcc,0x1f,0xcf,0xfb,0x0,0x0,0x0,0x0,0x0,0x4,0x44,0x40,0x0,0x0,0xcc,0x11,0xfc,0xfc,0xfc,0xff,0xb0,0x0,0x0,0x0,0x0,0x40,0x0,0x4,0x0,0x2c,0x11,0xff,0x1f,0xfc,0xfc,0xff,0xb0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x40,0xc,0xff,0xf1,0xec,0xff,0xcf,0xfb,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x4,0x0,0xcf,0xff,0xcf,0xff,0xff,0xb0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x40,0xc,0xff,0xff,0xfc,0xbb,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x40,0x0,0xcf,0xff,0xcb,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x11,0x1a,0xaa,0x4a,0xac,0xff,0xfc,0xfc,0xaa,0xaa,0xaa,0xaa,0xa0,0x0,0x88,0x11,0x77,0x77,0x77,0x4f,0xff,0xff,0xff,0xff,0xc7,0x77,0x77,0x77,0x77,0x88,0x8,0x88,0x19,0x99,0x99,0x99,0x99,0x99,0x99,0x99,0x99,0x99,0x99,0x99,0x88,0x80,0x0,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x80,0x0,0x0,0x0,0xaa,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x8a,0xaa,0xa0,0x0,0x0,0x0,0x0,0x0,0xaa,0xaa,0x88,0xaa,0xaa,0xa8,0x88,0xaa,0xaa,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x8,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x0,0x0,0x0,0x0,0x0};
//32x16
char sea[] = {0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11,0xee,0xe1,0x1e,0xee,0xee,0xee,0xee,0x11,0xee,0xee,0xee,0xee,0xee,0xee,0xe1,0xee,0xe1,0x11,0x11,0x11,0xe1,0x1e,0xe1,0x1e,0x1e,0xee,0xee,0xe1,0x1e,0xee,0x11,0x1e,0x11,0xee,0xee,0x11,0x11,0x1e,0x11,0xee,0xe1,0x11,0xe1,0x1e,0x11,0xe1,0x1e,0xe1,0xee,0xee,0xee,0x11,0x11,0x31,0x1e,0xee,0x3e,0xe1,0x1e,0xee,0xe1,0x1e,0xee,0xee,0xee,0xe3,0x31,0x1e,0xe3,0x33,0x11,0xe3,0x31,0x11,0xee,0xe3,0x33,0xe1,0xee,0xee,0xee,0x33,0x33,0x3e,0x3e,0xee,0x3e,0x3e,0xe3,0x3e,0xee,0x33,0xe3,0x3e,0xe3,0x3e,0x33,0x33,0x33,0x33,0x33,0xee,0xe3,0xee,0xee,0x33,0xe3,0x3e,0xee,0xe3,0x3e,0xe3,0xee,0xe3,0x3e,0xee,0xee,0xee,0xee,0xe3,0x3e,0xee,0xee,0xee,0xee,0x33,0x3e,0xee,0xee,0x36,0x66,0xee,0xee,0xe3,0x3e,0xe6,0x63,0xee,0xee,0xee,0x33,0x66,0x33,0xee,0xee,0x66,0x66,0x66,0xee,0xee,0xee,0x66,0x66,0x66,0xee,0x33,0x66,0x66,0x66,0xee,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x63,0x33,0x36,0x66,0x66,0x63,0x33,0x66,0x66,0x66,0x66,0x33,0x33,0x66,0x66,0x66,0x33,0x33,0x33,0x66,0x66,0x33,0x33,0x36,0x66,0x66,0x33,0x33,0x33,0x36,0x66,0x33,0x33,0x66,0x33,0x33,0x66,0x66,0x63,0x33,0x66,0x33,0x66,0x33,0x33,0x33,0x36,0x66,0x66,0x66,0x66,0x63,0x33,0x36,0x66,0x63,0x33,0x66,0x66,0x66,0x63,0x33,0x33,0x36,0x63,0x33,0x36,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x33,0x36,0x66,0x33,0x33,0x33,0x33,0x33,0x33,0x33,0x66,0x66,0x63,0x36,0x66,0x33,0x33,0x33,0x33,0x33,0x33,0x33,0x33,0x33,0x33,0x33,0x33,0x33,0x33,0x33,0x33};
//4x7
char hook[] = {0x0,0xb0,0xb,0xb,0x0,0xb0,0x0,0xbb,0x0,0xb,0xb0,0xb,0xb,0xb0};
//2x128
char fline[] = {0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10};
//26x15
char shark1[] = {0x0,0x0,0x0,0x0,0x0,0x0,0x6,0x66,0x66,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x6,0x66,0x66,0x90,0x0,0x0,0x0,0x0,0x0,0x0,0x66,0x66,0x66,0x66,0x66,0x69,0x0,0x0,0x0,0x0,0x0,0x0,0x66,0x66,0x66,0x66,0x66,0x66,0x69,0x0,0x0,0x0,0x0,0x66,0x6,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x0,0x0,0x6,0x60,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x0,0x66,0x60,0x66,0x66,0x66,0x66,0x66,0x69,0x69,0x69,0x66,0x66,0x99,0x66,0x60,0x66,0x66,0x66,0x66,0x66,0x69,0x69,0x69,0x66,0x66,0x66,0x66,0x0,0x6,0xaa,0xaa,0xaa,0x6b,0x69,0x69,0x69,0x66,0x66,0x66,0x66,0x0,0x0,0xa2,0x22,0x26,0x66,0x66,0x66,0x66,0x66,0x69,0x99,0x6,0x60,0x0,0xf,0xff,0x66,0x66,0x66,0x66,0x66,0x99,0x90,0x0,0x0,0x99,0x0,0x0,0x99,0xff,0xff,0xf6,0x66,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x9,0x99,0x90,0x0,0x6,0x66,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x9,0x90,0x0,0x0,0x0,0x66,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x9,0x0,0x0,0x0,0x0,0x6,0x0,0x0,0x0,0x0,0x0,0x0};
char shark2[] = {0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x6,0x66,0x66,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x6,0x66,0x66,0x90,0x0,0x0,0x0,0x0,0x0,0x0,0x66,0x66,0x66,0x66,0x66,0x69,0x0,0x0,0x0,0x6,0x0,0x0,0x66,0x66,0x66,0x66,0x66,0x66,0x69,0x0,0x0,0x0,0x6,0x60,0x6,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x0,0x0,0x6,0x60,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x0,0x66,0x60,0x66,0x66,0x66,0x66,0x66,0x69,0x69,0x69,0x66,0x66,0x99,0x66,0x60,0x66,0x66,0x66,0x66,0x66,0x69,0x69,0x69,0x66,0x66,0x66,0x66,0x0,0x6,0x66,0x6a,0xa6,0x6b,0x69,0x69,0x69,0x66,0x66,0x66,0x66,0x0,0x0,0x6a,0xa2,0x26,0x66,0x66,0x66,0x66,0x66,0x69,0x99,0x6,0x60,0x0,0xf,0xff,0x66,0x66,0x66,0x66,0x66,0x99,0x90,0x0,0x9,0x90,0x0,0x0,0x99,0xff,0xff,0xf6,0x66,0x0,0x0,0x0,0x0,0x90,0x0,0x0,0x9,0x99,0x0,0x0,0x0,0x66,0x60,0x0,0x0,0x0,0x0,0x0,0x0,0x99,0x90,0x0,0x0,0x0,0x6,0x66,0x0,0x0,0x0,0x0,0x0};
int shark[] = {shark1,shark2};
//12x8
char bones[] = {0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x10,0x10,0x0,0x0,0x0,0x1,0x10,0x10,0x10,0x0,0x1,0x11,0x10,0x10,0x10,0x10,0x10,0x10,0x11,0x11,0x11,0x11,0x0,0x11,0x10,0x10,0x10,0x10,0x10,0x1,0x10,0x10,0x10,0x0,0x1,0x0,0x10,0x10,0x0,0x0,0x0};
char fish1[] = {0x0,0x0,0x0,0xf0,0x0,0xf,0x0,0xff,0xff,0xff,0x0,0xfc,0xf,0xcc,0xc1,0xc1,0xff,0xcc,0xfc,0xc6,0xcc,0x1c,0xcc,0xcc,0xc,0xcc,0xc1,0xc1,0xcc,0xc0,0x0,0xcc,0x1c,0x1c,0xc,0xc0,0x0,0x0,0xc,0xc0,0x0,0xc0,0x0,0x0,0x0,0xc0,0x0,0x0,0x0,0x0,0x0,0xf0,0x0,0x0,0x0,0xff,0xff,0xff,0x0,0xf0,0xf,0xcc,0xc1,0xc1,0xff,0xc0,0xfc,0xc6,0xcc,0x1c,0xcc,0xc0,0xc,0xcc,0xc1,0xc1,0xcc,0xc0,0x0,0xcc,0x1c,0x1c,0xc,0xcc,0x0,0x0,0xc,0xc0,0x0,0xcc,0x0,0x0,0x0,0xc0,0x0,0xc};
char fish2[] = {0x0,0xa,0x7a,0x70,0x0,0xa,0x0,0xa2,0x21,0x27,0x0,0xaa,0x2,0x24,0x22,0x12,0x10,0x20,0x22,0x22,0x22,0x21,0x22,0x20,0x22,0x22,0x22,0x12,0x12,0x20,0x2,0x28,0x82,0x21,0x20,0x20,0x0,0x22,0x82,0x12,0x0,0x22,0x0,0x2,0x21,0x20,0x0,0x2,0x0,0xa,0x7a,0x70,0xa,0xa0,0x0,0xa2,0x21,0x27,0x0,0xa0,0x2,0x24,0x22,0x12,0x10,0x20,0x22,0x22,0x22,0x21,0x22,0x20,0x22,0x22,0x22,0x12,0x12,0x20,0x2,0x22,0x82,0x21,0x20,0x20,0x0,0x28,0x82,0x12,0x0,0x20,0x0,0x2,0x21,0x20,0x2,0x20};
//14x13
char watch[] = {0x0,0x0,0xb,0xbb,0x0,0x0,0x0,0x0,0xb,0xbf,0x1f,0xbb,0x0,0x0,0x0,0xbf,0x11,0x11,0x1f,0xb0,0x0,0xb,0xf1,0x11,0x41,0x11,0xfb,0x0,0xb,0x11,0x11,0x41,0x11,0x1b,0x0,0xbf,0x11,0x11,0x41,0x11,0x1f,0xb0,0xb1,0x11,0x11,0x22,0x22,0x21,0xb0,0xbf,0x11,0x11,0x11,0x11,0x1f,0xb0,0xb,0x11,0x11,0x11,0x11,0x1b,0x0,0xb,0xf1,0x11,0x11,0x11,0xfb,0x0,0x0,0xbf,0x11,0x11,0x1f,0xb0,0x0,0x0,0xb,0xbf,0x1f,0xbb,0x0,0x0,0x0,0x0,0xb,0xbb,0x0,0x0,0x0};
//28x26rle
char tittle[] = {0x83,0x11,0xff,0x3,0x0,0x83,0xf1,0x10,0x7,0x0,0x88,0xcc,0xff,0xf1,0x11,0xff,0xfc,0xc0,0x7,0x0,0x88,0xcc,0xcf,0x1f,0xff,0x1f,0xcc,0xc0,0x7,0x0,0x82,0xc,0x4,0xff,0x83,0xfc,0xc0,0x3,0x0,0x82,0xaa,0x4,0x0,0x86,0xff,0xbf,0xff,0xbf,0xf0,0x3,0x0,0x83,0xca,0x88,0x4,0x0,0x85,0xff,0xbf,0xff,0xbf,0x3,0x0,0x84,0xc,0xb8,0x81,0x3,0x0,0x83,0xcc,0xf,0x3,0xff,0x87,0xc,0xc0,0x0,0xcb,0xb8,0x1,0x4,0x0,0x82,0xcc,0x2,0xff,0x88,0xfc,0xc0,0x0,0xc,0xbb,0x0,0x1,0x5,0x0,0x2,0xff,0x2,0x0,0x86,0xc,0xcb,0xb0,0x0,0x9,0x4,0x0,0x85,0xcc,0xbf,0x2f,0xcc,0x3,0xbb,0x2,0x0,0x83,0xa9,0xa0,0x2,0x0,0x83,0xc,0xb,0x3,0xbb,0x83,0xcb,0xbb,0x2,0x0,0x84,0xa,0x22,0x2a,0x3,0x0,0x5,0xbb,0x3,0x0,0x2,0x22,0x85,0x92,0x20,0x0,0xc,0x5,0xbb,0x2,0x0,0x82,0x7,0x3,0x22,0x84,0x20,0x0,0xc,0x4,0xbb,0x82,0xb0,0x2,0x0,0x82,0x7,0x3,0x12,0x84,0x17,0x0,0xcc,0x4,0xbb,0x3,0x0,0x82,0x7,0x3,0x21,0x84,0x27,0x70,0xcb,0x4,0xbb,0x4,0x0,0x3,0x12,0x83,0x10,0x70,0x5,0xbb,0x4,0x0,0x3,0x21,0x85,0x20,0x0,0xbb,0xb,0x3,0xbb,0x4,0x0,0x82,0x2,0x2,0x12,0x2,0x0,0x83,0xbb,0xb,0x3,0xbb,0x5,0x0,0x83,0x22,0x20,0x2,0x0,0x83,0xbb,0xb,0x3,0xbb,0x5,0x0,0x82,0x2,0x3,0x0,0x83,0xbb,0xb,0x3,0xbb,0x4,0x0,0x84,0xa,0x22,0xa0,0x2,0x0,0x83,0xbb,0xb,0x3,0xbb,0x3,0x0,0x89,0xa,0xa2,0x0,0x2a,0xa0,0x0,0xbb,0xb,0x3,0xbb,0x3,0x0,0x82,0x22,0x3,0x0,0x85,0x22,0x0,0x88,0xb,0x3,0xbb,0x82,0xb0,0x8,0x0,0x83,0x88,0xb,0x3,0xbb,0x82,0xb0,0x9,0x0,0x82,0x9,0x3,0x99,0x82,0x90,0x8,0x0};

//sound
char sndup[] = "s:d=4,o=4,b=900:32e,32c,32f#,32c,32d#,32f#,32c,32f,32d#,32c#,32f,32g#,32g,32d#,32f,32c,32f#,32e,32c#,32d,32e,32c#";
char sndfish[] = "s:d=4,o=6,b=400:d,e,g,b";
char sndbones[] = "s:d=4,o=4,b=285:a,f#,e,d#";
char sndtime[] = "s:d=4,o=5,b=900:d,4d#,p,d,4d#,p,d,4d#,p,d,4d#";
char sndtittle[] = "J:d=4,o=6,b=100:16a7,16a7,16p,8a7,16f7,16d7,16p,8f7,16d7,16f7,16p,8a7,16f7,16d7,16p,f7,8p,16f7,8g7,16f7,16f7,16p,16f7,8f7,16g7,8p,e7,8p,16a7,16a7,16p,8a7,16f7,16d7,16p,8f7,16d7,16f7,16p,8a7,16f7,16d7,16p,f7,8p,16f7,8g7,16f7,16f7,16p,16f7,8f7,16g7,8p,2e7,8p,16p,16d7,8g7,16f7";

int seax, x, y, key, ishooked, a, score, maxscore, time, game, frame;

void onexitleft(int n){
	if(spritegetvalue(n, S_X) <= 0){
		spritesetvalue(n, S_X, 128);
		if(n == 9){
			spritesetvalue(n, S_Y, 90 + random(30));
		}
		else{
			spritesetvalue(n, S_Y, 50 + random(70));
		}
	}
}

void onexitright(int n){
	if(spritegetvalue(n, S_X) > 127){
		spritesetvalue(n, S_X, -40);
		spritesetvalue(n, S_Y, 50 + random(20));
	}
}

void hookoncollision(int n){
	if(ishooked == 0 && spritegetvalue(2, S_COLLISION) < 16){
		ishooked = spritegetvalue(2, S_COLLISION);
		loadrtttl(sndup, 1);
		playrtttl();
	}
}

void sharkoncollision(int n){
	a = spritegetvalue(16, S_COLLISION);
	if(a == ishooked && a != 15){
		ishooked = 17;
	}
	if(a < 15 && a > 3){
		putsprite(17, spritegetvalue(a, S_X), spritegetvalue(a, S_Y));
		spritesetvalue(17, S_ANGLE, 0);
		spritesetvalue(a, S_X, -40);
		spritesetvalue(a, S_Y, 50 + random(70));
	}
}

void drawscore(){
	setbgcolor(14);
	setcolor(1);
	gotoxy(0,0);
	printf("score %d ", score);
	gotoxy(18,0);
	printf("%d ", time);
}

void init(){
	int i;
	x = 4;
	y = 30;
	score = 0;
	time = 60;
	game = 1;
	frame = 0;
	setimagesize(1);
	loaddata("minifisherman", &maxscore);
	setbgcolor(3);
	clearscreen();
	getsprite(1,mouse);
	spritesetvalue(1, S_WIDTH, 32);
	spritesetvalue(1, S_HEIGHT, 16);
	putsprite(1, 4, 10);
	getsprite(2,hook);
	spritesetvalue(2, S_WIDTH, 4);
	spritesetvalue(2, S_HEIGHT, 7);
	spritesetvalue(2, S_ON_COLLISION, hookoncollision);
	putsprite(2, x, y);
	getsprite(3,fline);
	spritesetvalue(3, S_WIDTH, 2);
	spritesetvalue(3, S_HEIGHT, 16);
	putsprite(3, x + 2, 14);
	setcolor(14);
	for(i = 0; i < 16; i++){
		line(0, i, 127, i);
	}
	for(i = 0; i < 4; i++){
		putimage(sea, i * 32, 15, 32, 18);
	}
	settimer(1, 1000);
	while(gettimer(1)){}
	for(i = 4; i < 10; i++){
		getsprite(i,fish1);
		spritesetvalue(i, S_WIDTH, 12);
		spritesetvalue(i, S_HEIGHT, 8);
		spritesetvalue(i, S_ON_EXIT_SCREEN, onexitleft);
		putsprite(i, random(120), 40 + random(80));
	}
	getsprite(9,fish2);
	getsprite(16,shark);
	spritesetvalue(16, S_WIDTH, 26);
	spritesetvalue(16, S_HEIGHT, 15);
	spritesetvalue(16, S_FLIP_HORIZONTAL, 1);
	spritesetvalue(16, S_ON_EXIT_SCREEN, onexitright);
	spritesetvalue(16, S_ON_COLLISION, sharkoncollision);
	spritesetvalue(16, S_SPEEDX, 12);
	putsprite(16, random(12), 40 + random(80));
	getsprite(17, bones);
	spritesetvalue(17, S_WIDTH, 12);
	spritesetvalue(17, S_HEIGHT, 8);
	spritesetvalue(17, S_SPEEDY, 8);
	getsprite(15, watch);
	spritesetvalue(15, S_WIDTH, 14);
	spritesetvalue(15, S_HEIGHT, 13);
	settimer(1, 1000);
	settimer(2, 400);
	settimer(3, 6000);
	drawscore();
}

void timers(){
	if(gettimer(1) == 0){
		settimer(1, 1000);
		time--;
		if(time <= 0){
			game = 0;
		}
		drawscore();
	}
	if(gettimer(2) == 0){
		settimer(2, 400);
		frame = 1 - frame;
	}
	if(gettimer(3) == 0){
		settimer(3, 5000 + random(2000));
		putsprite(15, random(1) * 120, 60 + random(40));
		if(spritegetvalue(15, S_X)){
			spritesetvalue(15, S_SPEEDX, -16);
		}
		else{
			spritesetvalue(15, S_SPEEDX, 16);
		}
	}
}

void step(){
	int i;
	for(i = 0; i < 5; i++){
		putimage(sea, i * 32 - seax, 15, 32, 18);
	}
	spritesetvalue(1, S_ANGLE, 355 + seax / 4);
	seax = (seax + 1) & 31;
	key = getkey();
	if(ishooked){
		if(y > 30){
			y-=2;
		}
		else{
			if(ishooked < 15){
				spritesetvalue(ishooked, S_X, 128);
				spritesetvalue(ishooked, S_Y, 50 + random(70));
				score++;
				if(ishooked == 9){
					score += 2;
				}
				loadrtttl(sndfish, 0);
			}
			else{
				loadrtttl(sndbones, 0);
			}
			if(ishooked == 15){
				time += 8;
				spritesetvalue(15, S_LIVES, 0);
				loadrtttl(sndtime, 0);
			}
			ishooked = 0;
			drawscore();
			playrtttl();
		}
	}
	else{
		if((key & KEY_LEFT) && x > 0){
			x-=2;
		}
		if((key & KEY_RIGHT) && x < 110){
			x+=2;
		}
		if((key & KEY_DOWN) && y < 120){
			y+=2;
		}
		if((key & KEY_UP) && y > 30){
			y-=2;
		}
	}
	spritesetvalue(1, S_X, x);
	spritesetvalue(3, S_X, x + 2);
	spritesetvalue(3, S_HEIGHT, y - 14);
	putsprite(2, x, y);
	getsprite(16,shark[frame]);
	for(i = 4; i < 10; i++){
		getsprite(i,fish1 + frame * 48);
		spritesetvalue(i, S_SPEEDX, 0 - random(8));
		spritesetvalue(i, S_ANGLE, 10 - random(2) * 10);
	}
	getsprite(9,fish2 + frame * 48);
	if(ishooked){
		spritesetvalue(ishooked, S_ANGLE, 90);
		spritesetvalue(ishooked, S_SPEEDX, 0);
		spritesetvalue(ishooked, S_Y, y + 6);
		spritesetvalue(ishooked, S_X, x - 4);
	}
}

void end(){
	int i;
	loadrtttl(sndtittle, 1);
	playrtttl();
	for(i = 2; i < 32; i++){
		spritesetvalue(i, S_LIVES, 0);
	}
	if(score > maxscore){
		maxscore = score;
		savedata("minifisherman", &maxscore, 2);
	}
	setbgcolor(3);
	setcolor(1);
	gotoxy(6,5);
	printf("score    %d ", score);
	gotoxy(6,7);
	printf("maxscore %d ", maxscore);
	setimagesize(2);
	putimagerle(tittle, 40, 76, 28, 26);
	settimer(1, 1000);
	while(gettimer(1)){}
	while(getkey() == 0){}
	stoprtttl();
}

void main(){
	while(1){
		init();
		while(game){
			timers();
			step();
			delayredraw();
		}
		end();
	}
}